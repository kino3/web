<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" href="doc-styles.css" type="text/css"/>
<title>Movable Typeユーザー・マニュアル: サニタイズ: 入力された文字を安全に</title>
</head>

<body>
<h1 id="__index__">Movable Typeユーザー・マニュアル: サニタイズ: 入力された文字を安全に</h1>
<p><a href="mtmanual.html">&laquo; 目次</a></p>
<ul>
	<li><a href="#sanitize_cleaning_up_incoming_data">サニタイズ: 入力された文字を安全に</a>
	<ul>
		<li><a href="#default_usage">デフォルトでの使用</a></li>
		<li><a href="#overriding_defaults">デフォルトを上書きしたい場合</a></li>
	</ul>
	</li>
</ul>
<hr />

<h2><a name="sanitize_cleaning_up_incoming_data"></a>サニタイズ: 入力された文字を安全に</h2>
<p><strong>注：</strong>以下の説明は、ブログの設定にある「<em> コメントでのHTMLの利用を許可する </em> 」オプションをオンにしている場合だけに該当します。</p>
<p>訪問者があなたのサイトに提出したデータは、必ずしも常に信頼できるとは限りません。 たとえば、コメントでのHTMLを許可している場合、あなたのサイトの訪問者は、悪意のあるHTMLやJavaScriptのスクリプトやPHPを提出し、あなたのサイトでコードを実行しようとするかもしれません。 このコードは、クッキーの読み取りから、サーバーにある私的なファイルの読み取りに到る、あらゆることを引き起こしかねません。</p>
<p>あなたのサイトを保護するため、Movable Typeは、訪問者が投稿したすべてのデータを無害化(サニタイズ)します。 この中にはコメント・データとトラックバックのデータが含まれます。 この無害化は、サイトのセキュリティを脅かす可能性があるコード(HTMLその他)を削除することによります。 サニタイズ・プロセスでは、一部のHTMLタグだけが機能するようにし、そのほかのタグ、実行命令およびスクリプティング命令(PHP、JSP、JavaScript)はすべて取り除きます。</p>
<p>デフォルトで許可されているHTMLのタグとアトリビュート(属性)は<em> a href </em> 、<em> b </em> 、<em> br </em> 、<em> p </em> 、<em> strong </em> 、<em> em </em> 、<em> ul </em> 、<em> li </em> 、および<em> blockquote </em> です。 この設定は、<em> mt-config.cgi </em> ファイルの<em> GlobalSanitizeSpec </em> 設定を変更して全体的に上書きできます。また、ブログごとに変更したい場合は、ブログの設定で上書きできます。 <strong>注：</strong>この領域に精通していない方には、デフォルト設定のままにしておくことを推奨します。</p>
<p>サニタイズ・プロセスの別の機能として、テキストがサニタイズされた後、開いたままのタグに終了タグを補う機能があります。 たとえば、あなたのサイトの訪問者が<em> &lt;b> </em> タグを開き、閉じるのを忘れた場合は、サニタイズ・プロセスが<em> &lt;/b> </em> を追加します。</p>

<h2><a name="default_usage"></a>デフォルトでの使用</h2>
<p>デフォルト(標準)でサニタイズ機能は、以下のタグに対し自動的に有効になります。</p>
<ul>
<li><strong><a name="item_mtcommentauthor"><em> &lt;$MTCommentAuthor$> </em> </a></strong></li>
<li><strong><a name="item_mtcommentemail"><em> &lt;$MTCommentEmail$> </em> </a></strong></li>
<li><strong><a name="item_mtcommenturl"><em> &lt;$MTCommentURL$> </em> </a></strong></li>
<li><strong><a name="item_mtcommentbody"><em> &lt;$MTCommentBody$> </em> </a></strong></li>
<li><strong><a name="item_mtpingtitle"><em> &lt;$MTPingTitle$> </em> </a></strong></li>
<li><strong><a name="item_mtpingurl"><em> &lt;$MTPingURL$> </em> </a></strong></li>
<li><strong><a name="item_mtpingblogname"><em> &lt;$MTPingBlogName$> </em> </a></strong></li>
<li><strong><a name="item_mtpingexcerpt"><em> &lt;$MTPingExcerpt$> </em> </a></strong></li>
</ul>
<p>これは、以上のタグをセキュリティ上安全にするため、テンプレートを修正しなくてもよいことを意味します。 これらのタグのサニタイズを無効にする場合は、<em> sanitize </em> アトリビュートを使います。</p>
<pre>
&lt;$MTPingTitle sanitize="0"$>
</pre>

<h2><a name="overriding_defaults"></a>デフォルトを上書きしたい場合</h2>
<p>デフォルト(標準)のサニタイズ仕様を上書きするには、まずその理由を明確にし、上書きが本当に必要であるかどうかを確かめてください。 さらに、ここに説明するサニタイズ仕様のフォーマットを確実に理解してから上書きするようにしてください。</p>
<p>サニタイズ仕様はHTMLタグ名がコンマで区切られたものです。 各タグに対しあなたが許可するアトリビュートをスペースで区切り列挙します。 以下に例を挙げます。</p>
<p>これは、<em> a </em> タグとその<em> href </em> アトリビュート、そして<em> b </em> タグを許可したものです。</p>
<pre>
a href,b
</pre>
<p>これは、<em> p </em> タグと<em> br </em> タグを許可したものです。</p>
<pre>
p,br/
</pre>
<p>上の例にある<em> br/ </em> タグの<em> / </em> に注目してください。 これは、上述のタグを閉じる機能のために必要です。これがないと、サニタイズ・プロセス時に、テキストを解析するパーサーが、<em> &lt;br> </em> タグだけを見つけた場合、テキストの最後に終了タグを付ける必要があると判断します。 しかしタグ名の後に<em> / </em> を加えると、パーサーはそのタグには終了タグが必要ないと判断します。</p>
<p>あなたが許可するタグのアトリビュートは一つ一つ指定する必要があります。指定しないと、アトリビュートはどれも許可されない状態になります。 たとえば、<em> a </em> タグを許可した場合は、<em> href </em> アトリビュートも許可するのが賢明です。さもないと、</p>
<pre>
&lt;a href="http://www.example.com/">
</pre>
<p>というHTMLコードは、上書きしたサニタイズ機能によって、以下のようになってしまいます。</p>
<pre>
&lt;a>
</pre>
<p>これはおそらくあなたが望んだものではないことでしょう。</p>
<p>複数のHTMLタグに共通する1つのアトリビュートを許可する場合は、タグ名に<em> * </em> を用いた後、そのアトリビュート名を記述します。 以下に例を挙げます。</p>
<pre>
br/,p,blockquote,* style
</pre>
<p>この設定は、以下のHTMLコードを許可します。</p>
<pre>
&lt;br style="..." />
&lt;p style="..." />
&lt;blockquote style="..."></pre>
<p>このとき注意するのは、許可する<em> タグ </em> のリストを一つ一つ列挙する必要があるということです。<em> * </em> は、単にこれらの列挙したタグの中で、指定した<em> アトリビュート </em> を許可するという意味で使われます。</p>
<hr />

<span class="copyright">Copyright &copy; 2001-2005 Six Apart, Ltd. All Rights Reserved.</span>
</body>
</html>
